<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jason M. Pattison, ST 588-651 Summer 1 2024">

<title>Homework 4 - Hodge Podge</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Homework 4 - Hodge Podge</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jason M. Pattison, ST 588-651 Summer 1 2024 </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="homework-4-assignment-objectives" class="level1">
<h1>Homework 4 Assignment Objectives</h1>
<p>Task 1 for this homework assignment is practice with answering the types of questions that will be asked on the next exam.</p>
<p>Task 2 of the assignment involves writing R functions manually create functions that generate the Root Mean Square Error (RMSE) and Mean Absolute Deviation (MAE) given a set of response values.</p>
<p>Task 3 of the assignment focuses on querying an API and writing a function that queries the API and</p>
<section id="task-1-conceptual-questions" class="level2">
<h2 class="anchored" data-anchor-id="task-1-conceptual-questions">Task 1: Conceptual Questions</h2>
<ol type="1">
<li><p>What is the purpose of the <code>lapply()</code> function? What is the equivalent <code>purrr</code> function?</p>
<blockquote class="blockquote">
<p>The purpose <code>lapply()</code> is to apply a function to all variables in a data frame. <code>lapply</code>treats the variables in data frames as a list, and applies a called function to all objects in the list. The equivalent purrr function to<code>lapply()</code>is<code>map()</code>.</p>
</blockquote></li>
<li><p>Suppose we have a list called my_list. Each element of the list is a numeric data frame (all columns are numeric). We want use <code>lapply()</code> to run the code cor(numeric_matrix, method = “kendall”) on each element of the list. Write code to do this below! (I’m really trying to ask you how you specify method = “kendall” when calling <code>lapply()</code>)</p>
<blockquote class="blockquote">
<p>lapply(my_list, cor(numeric_matrix, method = “kendall”))</p>
</blockquote></li>
<li><p>What are two advantages of using purrr functions instead of the BaseR apply family?</p>
<blockquote class="blockquote">
<p><code>map()</code> is more consistent and has additional helper funcitons for use in analysis</p>
</blockquote></li>
<li><p>What is a side-effect function?</p>
<blockquote class="blockquote">
<p>A side-effect funciton is one where the state of the data is changed while returning a value. Some examples are <code>print()</code> and <code>plot()</code> where the function takes the data and creates the different outputs.</p>
</blockquote></li>
<li><p>Why can you name a variable sd in a function and not cause any issues with the sd function?</p>
<blockquote class="blockquote">
<p>The sd() function is global throughout R (via R packages). When use inside of a function, <code>sd</code> is a temporary variable that is local to the funciton it is in. Once the functioncode is finished running, the variable sd does not exist.</p>
</blockquote></li>
</ol>
</section>
<section id="task-2-writing-r-functions" class="level2">
<h2 class="anchored" data-anchor-id="task-2-writing-r-functions">Task 2: Writing R Functions</h2>
<p>Before we write any code, we want to ensure we establish a library for the functions to operate from so the program renders to Quarto properly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<section id="write-getrmse" class="level3">
<h3 class="anchored" data-anchor-id="write-getrmse">2.1. Write <code>getRMSE</code></h3>
<p>Step 1 of task 2 is to write a basic function called <code>getRMSE()</code> that takes in a vector of responses, a vector of predictions, and outputs the RMSE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># name the function "getRMSE", define "x" as our response</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># values and "y" as our predicted values. </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>getRMSE <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the loop required to subtract each predicted </span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># value from the corresponding response value.</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># subtract the predicted values from the observed values, square the difference, </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># sum the values, establish the mean of the sum, then take</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># the square root of the mean. </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: The order of which variable is subtracted from which</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># doesn't matter due to squaring the difference for each</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># iteration of the loop. </span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> x) {  </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  diff_sq <span class="ot">&lt;-</span> ((x <span class="sc">-</span> y)<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co"># take the square root of the mean of the diff_sq, define</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co"># it as "RMSE"</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  RMSE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(diff_sq))</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># output the result</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">"RMSE"</span> <span class="ot">=</span> RMSE)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># quickly test the function using 10 through 100 by ten as</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co"># the response and the mean as the predicted value for each</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co"># response to ensure there are no error codes</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>x_test <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">100</span>)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>y_test <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">55</span>, <span class="dv">55</span>, <span class="dv">55</span>, <span class="dv">55</span>, <span class="dv">55</span>, <span class="dv">55</span>, <span class="dv">55</span>, <span class="dv">55</span>, <span class="dv">55</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="fu">getRMSE</span>(x_test, y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE
[1] 28.72281</code></pre>
</div>
</div>
<p>The generic run of our function did not produce an error code, so we’re ready to move on to step 2.</p>
</section>
<section id="test-getrmse" class="level3">
<h3 class="anchored" data-anchor-id="test-getrmse">2.2. Test <code>getRMSE</code></h3>
<p>Step 2 of task 2 is to generate response and predicted values for x, then process those values through our <code>getRMSE</code> function.</p>
<p>First we will run the code provided in the homework assignment to create vectors of response values and predicted values. We will title these vectors <code>resp</code> and <code>pred</code> respectively.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>resp <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="fu">lm</span>(resp <span class="sc">~</span> x), <span class="fu">data.frame</span>(x))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="st">"response"</span> <span class="ot">=</span> resp, <span class="st">"predicted"</span> <span class="ot">=</span> pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$response
  [1]  7.674144  5.733128  8.637031 12.068788  4.357179  6.040709  4.843093
  [8]  6.255948  8.512399  7.587703  8.278962  8.221201  3.304767  9.299369
 [15]  7.646876  8.504220  4.254724  5.160568  7.550652 10.115022 12.028134
 [22]  7.723097  9.702653  6.337183  5.568563 11.239175  9.903050  4.965503
 [29]  9.656077  8.081564  8.948798  3.708220  5.410925 12.714925  7.666618
 [36] 10.636295 11.886290 14.767056  8.670500  7.931076  5.338484  5.097557
 [43]  3.213884 11.444994  6.093762  3.192188  1.563749  8.753929  4.177170
 [50] 12.242498  5.781476 12.783701  4.418721  8.442989  4.282396  9.395394
 [57]  8.255719  6.016290  8.026494  9.180810  2.038727  5.273544  7.225220
 [64]  6.654107 12.260485 10.688362  9.773488  8.216967  5.093565  6.142304
 [71]  3.274337  8.547150  9.381826  7.061813  4.016495  7.543794  6.976389
 [78] 11.550401  5.209433  3.872522 13.043037  8.277356  3.231859  8.553664
 [85]  4.576422  2.213665 11.475262  6.469006  5.333390  5.656304  6.209727
 [92]  8.908905  6.956097  9.642321  7.188749 12.413663  6.020730  8.507994
 [99] 11.776177  3.387353

$predicted
        1         2         3         4         5         6         7         8 
 8.148104  6.053163  7.307135 10.085585  3.739836  5.204247  5.716673  5.693445 
        9        10        11        12        13        14        15        16 
 9.279037  7.335984  9.652981  8.777073  4.035984  9.071286  6.588422  7.326985 
       17        18        19        20        21        22        23        24 
 3.392964  5.608614  7.013660 11.578506 11.876889  9.274059 10.941555  6.562523 
       25        26        27        28        29        30        31        32 
 7.087342 10.226961 11.600984  5.351967 10.896273  6.565957  8.441599  3.822838 
       33        34        35        36        37        38        39        40 
 4.623563 12.243368  7.262566 10.655945 11.437790 12.815573 10.005657  8.075302 
       41        42        43        44        45        46        47        48 
 5.726624  5.240438  3.001871 10.459905  5.459384  4.533592  3.029100  7.924969 
       49        50        51        52        53        54        55        56 
 3.925253 11.217497  6.549574 12.625387  5.417487  7.789709  4.850664  8.938692 
       57        58        59        60        61        62        63        64 
 7.647044  7.730136  7.024534  8.125218  3.184053  4.045989  7.745808  6.994831 
       65        66        67        68        69        70        71        72 
11.552256 10.795551  8.835719  7.522155  3.725912  5.138510  3.639992  8.429384 
       73        74        75        76        77        78        79        80 
 9.545482  8.338708  3.261221  8.548719  6.741992 12.884971  5.537261  5.021745 
       81        82        83        84        85        86        87        88 
11.842039  7.698384  5.177431  9.359619  4.976822  3.056559 11.180401  5.714464 
       89        90        91        92        93        94        95        96 
 4.590225  4.627202  7.950078 10.276667  9.029635  8.249127  6.834518 11.564354 
       97        98        99       100 
 5.450278  8.493829 10.615164  3.164468 </code></pre>
</div>
</div>
<p>Next we will test our function using the values we created for <code>resp</code> and <code>pred</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>getRMSE <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> x) {  </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    diff_sq <span class="ot">&lt;-</span> ((x <span class="sc">-</span> y)<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  RMSE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(diff_sq))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># output the result</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">"RMSE"</span> <span class="ot">=</span> RMSE)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">getRMSE</span>(resp, pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE
[1] 0.9581677</code></pre>
</div>
</div>
<p>Now that we have successfully tested our function, we are going to replace two response values with missing values using (NA_real_). We will call this new response vector <code>resp_NA</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>replace_values <span class="ot">&lt;-</span> <span class="fu">c</span>(resp[<span class="dv">1</span>], resp[<span class="dv">100</span>])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>resp_NA <span class="ot">&lt;-</span> <span class="fu">replace</span>(resp, resp <span class="sc">%in%</span> replace_values, <span class="cn">NA_real_</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="st">"response_NA"</span> <span class="ot">=</span> resp_NA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$response_NA
  [1]        NA  5.733128  8.637031 12.068788  4.357179  6.040709  4.843093
  [8]  6.255948  8.512399  7.587703  8.278962  8.221201  3.304767  9.299369
 [15]  7.646876  8.504220  4.254724  5.160568  7.550652 10.115022 12.028134
 [22]  7.723097  9.702653  6.337183  5.568563 11.239175  9.903050  4.965503
 [29]  9.656077  8.081564  8.948798  3.708220  5.410925 12.714925  7.666618
 [36] 10.636295 11.886290 14.767056  8.670500  7.931076  5.338484  5.097557
 [43]  3.213884 11.444994  6.093762  3.192188  1.563749  8.753929  4.177170
 [50] 12.242498  5.781476 12.783701  4.418721  8.442989  4.282396  9.395394
 [57]  8.255719  6.016290  8.026494  9.180810  2.038727  5.273544  7.225220
 [64]  6.654107 12.260485 10.688362  9.773488  8.216967  5.093565  6.142304
 [71]  3.274337  8.547150  9.381826  7.061813  4.016495  7.543794  6.976389
 [78] 11.550401  5.209433  3.872522 13.043037  8.277356  3.231859  8.553664
 [85]  4.576422  2.213665 11.475262  6.469006  5.333390  5.656304  6.209727
 [92]  8.908905  6.956097  9.642321  7.188749 12.413663  6.020730  8.507994
 [99] 11.776177        NA</code></pre>
</div>
</div>
<p>Next we will test our <code>getRMSE</code> function to determine how it responds with and without adding code to address the missing values in <code>resp_NA</code>.</p>
<p>First we will test getRMSE without specifying behavior to deal with the missing values. .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getRMSE</span>(resp_NA, pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE
[1] NA</code></pre>
</div>
</div>
<p>Running <code>resp_NA</code> through <code>getRMSE</code> produces the result of “NA”. This is due to the two NA values in the response variable not being suitable for computations, even while being numeric values themselves.</p>
<p>To correct this, we will add code to <code>getRMSE</code> that will replace any NA values in an analyzed vector with the mean of the vector’s other values. We will call the updated function <code>getRMSE_2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># update getRMSE to account for missing data in response variable, </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># call the updated function getRMSE_2</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>getRMSE_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">replace</span>(x, <span class="fu">is.na</span>(x), <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> x) {  </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    diff_sq <span class="ot">&lt;-</span> ((x <span class="sc">-</span> y)<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  RMSE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(diff_sq))</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># output the result</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">"RMSE"</span> <span class="ot">=</span> RMSE)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="fu">getRMSE_2</span>(resp_NA, pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE
[1] 1.053783</code></pre>
</div>
</div>
</section>
<section id="write-getmae" class="level3">
<h3 class="anchored" data-anchor-id="write-getmae">2.3. Write <code>getMAE</code></h3>
<p>Similar to our <code>getRMSE</code> function, we will utilize a loop function to generate the iterative values of <code>x[i]</code> and <code>y[i]</code> in order to calculate the difference between them. Next we will take the absolute difference of these values, then determine their mean in order to determine the Mean Absolute Deviation (MAE).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>getMAE <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> x) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    abs_diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(x<span class="sc">-</span>y)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  MAE <span class="ot">&lt;-</span> <span class="fu">mean</span>(abs_diff)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">"MAE"</span> <span class="ot">=</span> MAE)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">getMAE</span>(x_test, y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$MAE
[1] 25</code></pre>
</div>
</div>
<p>Conducting a generic test using the <code>x_test</code> and <code>y_test</code> vectors shows that the function did not produce an error. We are ready to further test our function.</p>
</section>
<section id="test-getmae" class="level3">
<h3 class="anchored" data-anchor-id="test-getmae">2.4. Test <code>getMAE</code></h3>
<p>Next, we will use the code provided to again generate vectors <code>resp</code> and <code>pred</code>. Seeing that this is the same code we used in Step 2, and that we did not alter either of the vectors in Step 2.2, we can safely pass these vectors through our<code>getMAE</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getMAE</span>(resp, pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$MAE
[1] 0.8155776</code></pre>
</div>
</div>
<p>We will now attempt to reproduce our <code>MAE</code> results using a response data set that has missing values. This is the same test we previous did for <code>getRMSE</code>, so we will use the response vector <code>resp_NA</code> to further test <code>getMAE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getMAE</span>(resp_NA, pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$MAE
[1] NA</code></pre>
</div>
</div>
<p>Like with our initial test of passing missing values through <code>getRMSE</code>, <code>getMAE</code> provides the result of “NA” due to the NA values.</p>
<p>We will now modify the function code to account for NA values, then retest the function using <code>resp_NA</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>getMAE_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">replace</span>(x, <span class="fu">is.na</span>(x), <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> x) {</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    abs_diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(x<span class="sc">-</span>y)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  MAE <span class="ot">&lt;-</span> <span class="fu">mean</span>(abs_diff)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">"MAE"</span> <span class="ot">=</span> MAE)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">getMAE_2</span>(resp_NA, pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$MAE
[1] 0.8584455</code></pre>
</div>
</div>
</section>
<section id="generate-wrapper-function-getrmse_mae" class="level3">
<h3 class="anchored" data-anchor-id="generate-wrapper-function-getrmse_mae">2.5. Generate wrapper function <code>getRMSE_MAE</code></h3>
<p>Now that we have established that our <code>getRMSE</code> and <code>getMAE</code> functions work properly, we will use them as helper functions inside of a wrapper function <code>getRMSE_MAE</code> that can be used to return either the RMSE, the MAE, or both results.</p>
<p>When returning the values, we will give them appropriate names to ensure we know which result applies to which statistic. We will generate the function returning both statistics as the default value.</p>
<p>Additionally, we will encase the function code inside of a <code>try()</code> function. This is necessary for <code>getRMSE_MAE</code> to test if the input values are atomic, numeric, and vectors then output a user generated error message and exit the function if any of these conditions aren’t met. Using <code>try()</code> allows the program to identify an issue with a single use of the function without preventing the remaining code chunks throughout the program from executing.</p>
<p>First we will generate the function, then test it using our <code>x_test</code> and <code>y_test</code> generic data to ensure the function works without errors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>getRMSE_MAE <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">stat =</span> <span class="st">"both"</span>) {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">try</span>({</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  error_code <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"The data is not atomic"</span>, <span class="st">"The data is not numeric"</span>, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"The data is not a vector"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.atomic</span>(x) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.atomic</span>(y)) {</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(error_code[<span class="dv">1</span>])</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.numeric</span>(x) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.numeric</span>(y)) {</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(error_code[<span class="dv">2</span>])</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.vector</span>(x) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.vector</span>(y)) {</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(error_code[<span class="dv">3</span>])</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  RMSE <span class="ot">&lt;-</span> <span class="fu">getRMSE_2</span>(x,y)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  MAE <span class="ot">&lt;-</span> <span class="fu">getMAE_2</span>(x,y)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(stat <span class="sc">==</span> <span class="st">"both"</span>) {</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(RMSE)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(MAE)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(stat <span class="sc">==</span> <span class="st">"RMSE"</span>) {</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>      RMSE</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(stat <span class="sc">==</span> <span class="st">"MAE"</span>) {</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>      MAE</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Incorrect Statistic Selection"</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="fu">getRMSE_MAE</span>(x_test, y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE
[1] 28.72281

$MAE
[1] 25</code></pre>
</div>
</div>
<p>The function appears to be operational, so we are read to move on to the next step.</p>
</section>
<section id="test-the-new-wrapper-function." class="level3">
<h3 class="anchored" data-anchor-id="test-the-new-wrapper-function.">2.6. Test the new wrapper function.</h3>
<p>We will again use the provided code to generate response (<code>resp</code>) and prediction (<code>pred</code>) variables for use in testing our wrapper function.</p>
<blockquote class="blockquote">
<p>set.seed(10)</p>
<p>n &lt;- 100 x &lt;- runif(n)</p>
<p>resp &lt;- 3 + 10*x + rnorm(n)</p>
<p>pred &lt;- predict(lm(resp ~ x), data.frame(x))</p>
</blockquote>
<p>Because this is the same code we used earlier in this report, and we have not modified either of the vectors earlier throughout the report, we can safely process them through <code>getRMSE_MAE</code>.</p>
<p>We will use <code>getRMSE_MAE</code> once to output each statistic individually, then once to output both statistics together.</p>
<p>First we will output the <code>RMSE</code> value by explicitly listing it in the function values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getRMSE_MAE</span>(resp, pred, <span class="st">"RMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE
[1] 0.9581677</code></pre>
</div>
</div>
<p>Next we will output the <code>MAE</code> value by explicitly listing it in the function values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getRMSE_MAE</span>(resp, pred, <span class="st">"MAE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$MAE
[1] 0.8155776</code></pre>
</div>
</div>
<p>Now we will output both <code>RMSE</code> and <code>MAE</code> together. Because we have set the default value for <code>statistic</code> as “both”, we will only input the response and predicted vectors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getRMSE_MAE</span>(resp, pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE
[1] 0.9581677

$MAE
[1] 0.8155776</code></pre>
</div>
</div>
<p>We will now repeat testing `getRMSE_MAE` after replacing two of the response values with missing values using <code>NA_real_</code>.</p>
<p>This is the same process we used earlier in this report to generate our vector <code>resp_NA</code>. Because we have not modified <code>resp_NA</code> earlier throughout this report, we can safely process it through <code>getRMSE_MAE</code>.</p>
<p>Processing <code>resp_NA</code>’s values through <code>getRMSE_MAE</code> generates resulting outputs .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getRMSE_MAE</span>(resp_NA, pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE
[1] 1.053783

$MAE
[1] 0.8584455</code></pre>
</div>
</div>
<p>Which is not how the homework is written for this step. Our function works properly while the homework is written in a way that suggests that “NA” responses for both RMSE and MAE should have generated.</p>
<p>We did not receive the expected “NA” responses for both outputs because we used our improved functions <code>getRMSE_2</code> and <code>getMAE_2</code> when writing <code>getRMSE_MAE</code>. Both of these helper functions have code written in them to replace missing values with the mean of the other values in the vector. This resulted in the RMSE and MAE values being output instead of “NA”.</p>
<p>Finally, we will test the function by using an incorrect data type, a data frame instead of a vector, for one of our funciton inputs. To do this, we will first generate a data frame using the response and predicted variables, and name it <code>resp_df</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>resp_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"response"</span> <span class="ot">=</span> resp, <span class="st">"predicted"</span> <span class="ot">=</span> pred)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>resp_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(resp_list)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(resp_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [100 × 2] (S3: tbl_df/tbl/data.frame)
 $ response : num [1:100] 7.67 5.73 8.64 12.07 4.36 ...
 $ predicted: Named num [1:100] 8.15 6.05 7.31 10.09 3.74 ...
  ..- attr(*, "names")= chr [1:100] "1" "2" "3" "4" ...</code></pre>
</div>
</div>
<p>Then we will attempt to process the data frame through <code>getRMSE_MAE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getRMSE_MAE</span>(resp_df, pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The data is not atomic"
Error in try({ : no loop for break/next, jumping to top level</code></pre>
</div>
</div>
<p>We see that our screening criteria worked properly, generating an output message while displaying where the error in the function occurred. This error occurred due to the <code>if</code> statement testing <code>!is.atomic()</code> being <code>TRUE</code>, causing the associated <code>break</code> command to be executed.</p>
</section>
</section>
<section id="task-3-querying-an-api-and-a-tidy-style-function" class="level2">
<h2 class="anchored" data-anchor-id="task-3-querying-an-api-and-a-tidy-style-function">Task 3: Querying an API and a Tidy-Style Function</h2>
<section id="using-get" class="level3">
<h3 class="anchored" data-anchor-id="using-get">3.1. Using GET()</h3>
<p>Using <code>GET()</code> from the <code>httr</code> package, we will pull information from the “newsapi.org” website about a topic that has been in the news lately and store the information in variable `site_raw_data`.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>site_raw_data <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="st">"https://newsapi.org/v2/everything?q=Apple&amp;from=2024-06-01&amp;sortBy=popularity&amp;apiKey=b5c4c79305fb46db9e6212948cdf50e0"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>site_raw_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response [https://newsapi.org/v2/everything?q=Apple&amp;from=2024-06-01&amp;sortBy=popularity&amp;apiKey=b5c4c79305fb46db9e6212948cdf50e0]
  Date: 2024-06-23 18:45
  Status: 200
  Content-Type: application/json; charset=utf-8
  Size: 67.7 kB</code></pre>
</div>
</div>
<p>The <code>GET()</code> function worked properly, so we are ready to move on to the next step.</p>
</section>
<section id="parse-the-returned-information" class="level3">
<h3 class="anchored" data-anchor-id="parse-the-returned-information">3.2. Parse the returned information</h3>
<p>Next we are going to parse our created variable <code>site_raw_data</code> into a data frame with the article information in it. When creating the data frame, we will ensure that the title, author, and description of the articles are listed first. We will also ensure to omit articles from our search that may have been removed by the host site. Lastly, we will sort the results to ensure the most recent articles are listed first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>parsed <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(<span class="fu">rawToChar</span>(site_raw_data<span class="sc">$</span>content))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  articles <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(parsed<span class="sc">$</span>articles) <span class="sc">|&gt;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(title, author, description, <span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(title <span class="sc">!=</span> <span class="st">"[Removed]"</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(publishedAt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `as.tibble()` was deprecated in tibble 2.0.0.
ℹ Please use `as_tibble()` instead.
ℹ The signature and semantics have changed, see `?as_tibble`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>articles</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 76 × 8
   title       author description source$id url   urlToImage publishedAt content
   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  
 1 Typing to … Victo… "In iOS 18… the-verge http… https://c… 2024-06-22… "Typin…
 2 Bugatti’s … Jason… "Furiously… wired     http… https://m… 2024-06-20… "The r…
 3 EU delays … Kris … "European … &lt;NA&gt;      http… &lt;NA&gt;       2024-06-20… "If yo…
 4 Ex-OpenAI … Benj … "Safe Supe… ars-tech… http… https://c… 2024-06-20… "Enlar…
 5 Xbox Game … Quent… "CDKeys is… the-verge http… https://c… 2024-06-19… "Xbox …
 6 The Mornin… Mat S… "Nintendo … &lt;NA&gt;      http… &lt;NA&gt;       2024-06-19… "If yo…
 7 This unive… Quent… "Cantata h… the-verge http… https://c… 2024-06-18… "This …
 8 Nvidia ove… Richa… "Nvidia’s … the-verge http… https://c… 2024-06-18… "Nvidi…
 9 Beats Solo… Billy… "The idea … &lt;NA&gt;      http… &lt;NA&gt;       2024-06-18… "If yo…
10 Your Apple… Dua R… "WWDC 2024… &lt;NA&gt;      http… https://i… 2024-06-18… "WWDC …
# ℹ 66 more rows
# ℹ 1 more variable: source$name &lt;chr&gt;</code></pre>
</div>
</div>
<p>The parsing and data frame generation was a success. We are now ready to combine these separate operations into a function to query articles.</p>
</section>
<section id="write-an-api-query-function" class="level3">
<h3 class="anchored" data-anchor-id="write-an-api-query-function">3.3. Write an API query function</h3>
<p>Now that we have successfully retrieved and parsed the data into a tibble separately, we will write a quick function that allows the user to easily query the API using inputs for the title/subject, a time period for the search, and an API key.</p>
<p>When developing our function, we tested it using the inputs “Apple”, “2024-06-01”, and the API that “newsapi.org” provided.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>getArticles <span class="ot">&lt;-</span> <span class="cf">function</span>(subject, date_start, APIkey) {</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  subject <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(subject,<span class="st">" "</span>, <span class="st">"%20"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  sitestring <span class="ot">&lt;-</span>  httr<span class="sc">::</span><span class="fu">GET</span>(<span class="fu">str_c</span>(<span class="st">"https://newsapi.org/v2/everything?q="</span>, subject, <span class="st">"&amp;from="</span>, date_start, <span class="st">"&amp;sortBy=popularity&amp;apiKey="</span>, APIkey)) </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  parsed <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(<span class="fu">rawToChar</span>(sitestring<span class="sc">$</span>content))</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  articles <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(parsed<span class="sc">$</span>articles) <span class="sc">|&gt;</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(title, author, description, <span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(title <span class="sc">!=</span> <span class="st">"[Removed]"</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(publishedAt))</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  articles</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="fu">getArticles</span>(<span class="st">"Apple"</span>, <span class="st">"2024-06-01"</span>, <span class="st">"b5c4c79305fb46db9e6212948cdf50e0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 76 × 8
   title       author description source$id url   urlToImage publishedAt content
   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  
 1 Typing to … Victo… "In iOS 18… the-verge http… https://c… 2024-06-22… "Typin…
 2 Bugatti’s … Jason… "Furiously… wired     http… https://m… 2024-06-20… "The r…
 3 EU delays … Kris … "European … &lt;NA&gt;      http… &lt;NA&gt;       2024-06-20… "If yo…
 4 Ex-OpenAI … Benj … "Safe Supe… ars-tech… http… https://c… 2024-06-20… "Enlar…
 5 Xbox Game … Quent… "CDKeys is… the-verge http… https://c… 2024-06-19… "Xbox …
 6 The Mornin… Mat S… "Nintendo … &lt;NA&gt;      http… &lt;NA&gt;       2024-06-19… "If yo…
 7 This unive… Quent… "Cantata h… the-verge http… https://c… 2024-06-18… "This …
 8 Nvidia ove… Richa… "Nvidia’s … the-verge http… https://c… 2024-06-18… "Nvidi…
 9 Beats Solo… Billy… "The idea … &lt;NA&gt;      http… &lt;NA&gt;       2024-06-18… "If yo…
10 Your Apple… Dua R… "WWDC 2024… &lt;NA&gt;      http… https://i… 2024-06-18… "WWDC …
# ℹ 66 more rows
# ℹ 1 more variable: source$name &lt;chr&gt;</code></pre>
</div>
</div>
<p>We see that our initial code works, so let’s test it out two times using more complicated title/subject entries.</p>
<p>Searching for “Caitlin Clark”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getArticles</span>(<span class="st">"Caitlin Clark"</span>, <span class="st">"2024-06-10"</span>, <span class="st">"b5c4c79305fb46db9e6212948cdf50e0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 97 × 8
   title       author description source$id url   urlToImage publishedAt content
   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  
 1 Caitlin Cl…  &lt;NA&gt;  "Caitlin C… fox-spor… http… https://a… 2024-06-22… "The I…
 2 Fever's Ca… "Jose… "Indiana F… bleacher… http… https://m… 2024-06-22… "Jeff …
 3 Insider To… "Joi-… "In Saturd… business… http… https://i… 2024-06-22… "Getty…
 4 Aces Top W… "Jay … "Record vi… &lt;NA&gt;      http… https://i… 2024-06-22… "In th…
 5 Caitlin Cl… "Andr… "The India… bleacher… http… https://m… 2024-06-22… "Adam …
 6 WNBA rooki… "Emma… "The \"Dou… &lt;NA&gt;      http… https://n… 2024-06-21… "Chica…
 7 Caitlin Cl… "Paul… "Indiana F… bleacher… http… https://m… 2024-06-21… "Emile…
 8 The Need F… "Bria… "Financial… &lt;NA&gt;      http… https://i… 2024-06-21… "In Ju…
 9 A'ja Wilso… "DOUG… "A’ja Wils… abc-news  http… https://i… 2024-06-21… "NEW Y…
10 Wilson, Cl… "Mich… "The Aces'… espn      http… https://a… 2024-06-21… "The L…
# ℹ 87 more rows
# ℹ 1 more variable: source$name &lt;chr&gt;</code></pre>
</div>
</div>
<p>Searching for “United States heat wave”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getArticles</span>(<span class="st">"United States heat wave"</span>, <span class="st">"2024-06-01"</span>, <span class="st">"b5c4c79305fb46db9e6212948cdf50e0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 84 × 8
   title       author description source$id url   urlToImage publishedAt content
   &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  
 1 Helicopter… ED WH… "The gover… &lt;NA&gt;      http… https://b… 2024-06-22… "The g…
 2 Helicopter… ED WH… "The gover… &lt;NA&gt;      http… https://i… 2024-06-22… "The g…
 3 Eastern he… Alex … "Hot and c… &lt;NA&gt;      http… https://m… 2024-06-22… "June …
 4 Scorching … &lt;NA&gt;   "Millions … cbs-news  http… https://a… 2024-06-22… "A rel…
 5 FEMA is re… REBEC… "The head … &lt;NA&gt;      http… https://i… 2024-06-21… "WASHI…
 6 Climate ch… Assoc… "This mont… nbc-news  http… https://m… 2024-06-21… "Human…
 7 Trump clas… Eliza… "The judge… nbc-news  http… https://m… 2024-06-21… "The j…
 8 Little rel… Alexa… "There was… nbc-news  http… https://m… 2024-06-21… "There…
 9 The Art of… Frida… "( Tomdisp… &lt;NA&gt;      http… https://m… 2024-06-21… "( Tom…
10 Heat wave … Rache… "Heat wave… &lt;NA&gt;      http… https://u… 2024-06-20… "Heat …
# ℹ 74 more rows
# ℹ 1 more variable: source$name &lt;chr&gt;</code></pre>
</div>
</div>
<p>Each of these iterations are a success. However, there is a flaw in the code design that could not be resolved. I was not able to find any code online that would assist with taking various ways of inputting the date and converting it into the <code>ymd()</code> format required for URL use.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>